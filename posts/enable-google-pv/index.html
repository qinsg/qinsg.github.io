<!DOCTYPE html><html lang="zh-CN" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="启用Google Page Views" /><meta name="author" content="sille_bille" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="This post is to enable Page Views on the Chirpy theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the google_analytics.pv.* empty unless you have a good reason. If your website has low traffic, the page views count would discourage you to write more blogs. With that said, let’s start with the setup." /><meta property="og:description" content="This post is to enable Page Views on the Chirpy theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the google_analytics.pv.* empty unless you have a good reason. If your website has low traffic, the page views count would discourage you to write more blogs. With that said, let’s start with the setup." /><link rel="canonical" href="https://qinsg.github.io/posts/enable-google-pv/" /><meta property="og:url" content="https://qinsg.github.io/posts/enable-google-pv/" /><meta property="og:site_name" content="码农二十年" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-08-10T07:32:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="启用Google Page Views" /><meta name="twitter:site" content="@Rubin65397226" /><meta name="twitter:creator" content="@sille_bille" /><meta name="google-site-verification" content="google4a5e9c07a53d6b47.html" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"sille_bille"},"dateModified":"2019-08-10T07:32:00+08:00","datePublished":"2019-08-10T07:32:00+08:00","description":"This post is to enable Page Views on the Chirpy theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the google_analytics.pv.* empty unless you have a good reason. If your website has low traffic, the page views count would discourage you to write more blogs. With that said, let’s start with the setup.","headline":"启用Google Page Views","mainEntityOfPage":{"@type":"WebPage","@id":"https://qinsg.github.io/posts/enable-google-pv/"},"url":"https://qinsg.github.io/posts/enable-google-pv/"}</script><title>启用Google Page Views | 码农二十年</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="码农二十年"><meta name="application-name" content="码农二十年"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">码农二十年</a></div><div class="site-subtitle font-italic">善战者，求之于势，不责于人。</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/qinsg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Rubin65397226" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['shiguo.qin','gmail.com'].join('@')" aria-label="email" target="_blank" rel="noopener"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" target="_blank" rel="noopener"> <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>启用Google Page Views</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>启用Google Page Views</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1565393520" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2019-08-10 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> James Qin </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1338 字"> <em>7 分钟</em>阅读</span></div></div></div><div class="post-content"><p>This post is to enable Page Views on the <a href="https://github.com/cotes2020/jekyll-theme-chirpy/"><strong>Chirpy</strong></a> theme based blog that you just built. This requires technical knowledge and it’s recommended to keep the <code class="language-plaintext highlighter-rouge">google_analytics.pv.*</code> empty unless you have a good reason. If your website has low traffic, the page views count would discourage you to write more blogs. With that said, let’s start with the setup.</p><h2 id="set-up-google-analytics"><span class="mr-2">Set up Google Analytics</span><a href="#set-up-google-analytics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="create-ga-account-and-property"><span class="mr-2">Create GA account and property</span><a href="#create-ga-account-and-property" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, you need to set up your account on Google analytics. While you create your account, you must create your first <strong>Property</strong> as well.</p><ol><li>Head to <a href="https://analytics.google.com/">https://analytics.google.com/</a> and click on <strong>Start Measuring</strong><li>Enter your desired <em>Account Name</em> and choose the desired checkboxes<li>Enter your desired <em>Property Name</em>. This is the name of the tracker project that appears on your Google Analytics dashboard<li>Enter the required information <em>About your business</em><li>Hit <em>Create</em> and accept any license popup to set up your Google Analytics account and create your property</ol><h3 id="create-data-stream"><span class="mr-2">Create Data Stream</span><a href="#create-data-stream" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With your property created, you now need to set up Data Stream to track your blog traffic. After you signup, the prompt should automatically take you to create your first <strong>Data Stream</strong>. If not, follow these steps:</p><ol><li>Go to <strong>Admin</strong> on the left column<li>Select the desired property from the drop-down on the second column<li>Click on <strong>Data Streams</strong><li>Add a stream and click on <strong>Web</strong><li>Enter your blog’s URL</ol><p>It should look like this:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1086 542'%3E%3C/svg%3E" data-src="/posts/20210103/01-google-analytics-data-stream.png" alt="google-analytics-data-stream" width="1086" height="542" data-proofer-ignore></p><p>Now, click on the new data stream and grab the <strong>Measurement ID</strong>. It should look something like <code class="language-plaintext highlighter-rouge">G-V6XXXXXXXX</code>. Copy this to your <code class="language-plaintext filepath highlighter-rouge">_config.yml</code> file:</p><div file="_config.yml" class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="_config.yml"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="na">google_analytics</span><span class="pi">:</span>
  <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">G-V6XXXXXXX'</span>   <span class="c1"># fill in your Google Analytics ID</span>
  <span class="c1"># Google Analytics pageviews report settings</span>
  <span class="na">pv</span><span class="pi">:</span>
    <span class="na">proxy_endpoint</span><span class="pi">:</span>   <span class="c1"># fill in the Google Analytics superProxy endpoint of Google App Engine</span>
    <span class="na">cache_path</span><span class="pi">:</span>       <span class="c1"># the local PV cache data, friendly to visitors from GFW region</span>
</pre></table></code></div></div><p>When you push these changes to your blog, you should start seeing the traffic on your Google Analytics. Play around with the Google Analytics dashboard to get familiar with the options available as it takes like 5 mins to pick up your changes. You should now be able to monitor your traffic in real time.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 616 557'%3E%3C/svg%3E" data-src="/posts/20210103/02-google-analytics-realtime.png" alt="google-analytics-realtime" width="616" height="557" data-proofer-ignore></p><h2 id="setup-page-views"><span class="mr-2">Setup Page Views</span><a href="#setup-page-views" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a detailed <a href="https://developers.google.com/analytics/solutions/google-analytics-super-proxy">tutorial</a> available to set up Google Analytics superProxy. But, if you are interested to just quickly get your Chirpy-based blog display page views, follow along. These steps were tested on a Linux machine. If you are running Windows, you can use the Git bash terminal to run Unix-like commands.</p><h3 id="setup-google-app-engine"><span class="mr-2">Setup Google App Engine</span><a href="#setup-google-app-engine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><p>Visit <a href="https://console.cloud.google.com/appengine">https://console.cloud.google.com/appengine</a></p><li><p>Click on <strong>Create Application</strong></p><li><p>Click on <strong>Create Project</strong></p><li><p>Enter the name and choose the data center close to you</p><li><p>Select <strong>Python</strong> language and <strong>Standard</strong> environment</p><li><p>Enable billing account. Yeah, you have to link your credit card. But, you won’t be billed unless you exceed your free quota. For a simple blog, the free quota is more than sufficient.</p><li><p>Go to your App Engine dashboard on your browser and select <strong>API &amp; Services</strong> from the left navigation menu</p><li><p>Click on <strong>Enable APIs and Services</strong> button on the top</p><li><p>Enable the following APIs: <em>Google Analytics API</em></p><li><p>On the left, Click on <em>OAuth Consent Screen</em> and accept <strong>Configure Consent Screen</strong>. Select <strong>External</strong> since your blog is probably hosted for the public. Click on <strong>Publish</strong> under <em>Publishing Status</em></p><li><p>Click on <strong>Credentials</strong> on the left and create a new <strong>OAuth Client IDs</strong> credential. Make sure to add an entry under <code class="language-plaintext highlighter-rouge">Authorized redirect URIs</code> that matches: <code class="language-plaintext highlighter-rouge">https://&lt;project-id&gt;.&lt;region&gt;.r.appspot.com/admin/auth</code></p><li><p>Note down the <strong>Your Client ID</strong> and <strong>Your Client Secret</strong>. You’ll need this in the next section.</p><li><p>Download and install the cloud SDK for your platform: <a href="https://cloud.google.com/sdk/docs/quickstart">https://cloud.google.com/sdk/docs/quickstart</a></p><li><p>Run the following commands:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="gp">[root@bc96abf71ef8 /]#</span><span class="w"> </span>gcloud init
<span class="go">
~snip~

Go to the following link in your browser:

    https://accounts.google.com/o/oauth2/auth?response_type=code&amp;client_id=XYZ.apps.googleusercontent.com&amp;redirect_uri=ABCDEFG

</span><span class="gp">Enter verification code: &lt;VERIFICATION CODE THAT YOU GET AFTER YOU VISIT AND AUTHENTICATE FROM THE ABOVE LINK&gt;</span><span class="w">
</span><span class="go">
You are logged in as: [blah_blah@gmail.com].

Pick cloud project to use:
[1] chirpy-test-300716
[2] Create a new project
Please enter numeric choice or text value (must exactly match list
item): 1


</span><span class="gp">[root@bc96abf71ef8 /]#</span><span class="w"> </span>gcloud info
<span class="gp">#</span><span class="w"> </span>Your selected project info should be displayed here
</pre></table></code></div></div></ol><h3 id="setup-google-analytics-superproxy"><span class="mr-2">Setup Google Analytics superProxy</span><a href="#setup-google-analytics-superproxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><p>Clone the <strong>Google Analytics superProxy</strong> project on Github: <a href="https://github.com/googleanalytics/google-analytics-super-proxy">https://github.com/googleanalytics/google-analytics-super-proxy</a> to your local.</p><li><p>Remove the first 2 lines in the <a href="https://github.com/googleanalytics/google-analytics-super-proxy/blob/master/src/app.yaml#L1-L2"><code class="language-plaintext filepath highlighter-rouge">src/app.yaml</code></a> file:</p><div class="language-diff highlighter-rouge"><div class="code-header"> <span data-label-text="Diff"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gd">- application: your-project-id
- version: 1
</span></pre></table></code></div></div><li><p>In <code class="language-plaintext filepath highlighter-rouge">src/config.py</code>, add the <code class="language-plaintext highlighter-rouge">OAUTH_CLIENT_ID</code> and <code class="language-plaintext highlighter-rouge">OAUTH_CLIENT_SECRET</code> that you gathered from your App Engine Dashboard.</p><li><p>Enter any random key for <code class="language-plaintext highlighter-rouge">XSRF_KEY</code>, your <code class="language-plaintext filepath highlighter-rouge">config.py</code> should look similar to this</p><div file="src/config.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="src/config.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python2.7
</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s">'pete.frisella@gmail.com (Pete Frisella)'</span>

<span class="c1"># OAuth 2.0 Client Settings
</span><span class="n">AUTH_CONFIG</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'OAUTH_CLIENT_ID'</span><span class="p">:</span> <span class="s">'YOUR_CLIENT_ID'</span><span class="p">,</span>
  <span class="s">'OAUTH_CLIENT_SECRET'</span><span class="p">:</span> <span class="s">'YOUR_CLIENT_SECRET'</span><span class="p">,</span>
  <span class="s">'OAUTH_REDIRECT_URI'</span><span class="p">:</span> <span class="s">'%s%s'</span> <span class="o">%</span> <span class="p">(</span>
    <span class="s">'https://chirpy-test-XXXXXX.ue.r.appspot.com'</span><span class="p">,</span>
    <span class="s">'/admin/auth'</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="c1"># XSRF Settings
</span><span class="n">XSRF_KEY</span> <span class="o">=</span> <span class="s">'OnceUponATimeThereLivedALegend'</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>You can configure a custom domain instead of <code class="language-plaintext highlighter-rouge">https://PROJECT_ID.REGION_ID.r.appspot.com</code>. But, for the sake of keeping it simple, we will be using the Google provided default URL.</p></div></blockquote><li><p>From inside the <code class="language-plaintext filepath highlighter-rouge">src/</code> directory, deploy the app</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="gp">[root@bc96abf71ef8 src]#</span><span class="w"> </span>gcloud app deploy
<span class="go">Services to deploy:

descriptor:      [/tmp/google-analytics-super-proxy/src/app.yaml]
source:          [/tmp/google-analytics-super-proxy/src]
target project:  [chirpy-test-XXXX]
target service:  [default]
target version:  [VESRION_NUM]
target url:      [https://chirpy-test-XXXX.ue.r.appspot.com]


Do you want to continue (Y/n)? Y

Beginning deployment of service [default]...
╔════════════════════════════════════════════════════════════╗
╠═ Uploading 1 file to Google Cloud Storage                 ═╣
╚════════════════════════════════════════════════════════════╝
File upload done.
Updating service [default]...done.
Setting traffic split for service [default]...done.
Deployed service [default] to [https://chirpy-test-XXXX.ue.r.appspot.com]

You can stream logs from the command line by running:
</span><span class="gp">$</span><span class="w"> </span>gcloud app logs <span class="nb">tail</span> <span class="nt">-s</span> default
<span class="go">
To view your application in the web browser run:
</span><span class="gp">$</span><span class="w"> </span>gcloud app browse
</pre></table></code></div></div><li><p>Visit the deployed service. Add a <code class="language-plaintext highlighter-rouge">/admin</code> to the end of the URL.</p><li><p>Click on <strong>Authorize Users</strong> and make sure to add yourself as a managed user.</p><li><p>If you get any errors, please Google it. The errors are self-explanatory and should be easy to fix.</p></ol><p>If everything went good, you’ll get this screen:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1366 354'%3E%3C/svg%3E" data-src="/posts/20210103/03-superProxy-deployed.png" alt="superProxy-deployed" width="1366" height="354" data-proofer-ignore></p><h3 id="create-google-analytics-query"><span class="mr-2">Create Google Analytics Query</span><a href="#create-google-analytics-query" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Head to <code class="language-plaintext highlighter-rouge">https://PROJECT_ID.REGION_ID.r.appspot.com/admin</code> and create a query after verifying the account. <strong>GA Core Reporting API</strong> query request can be created in <a href="https://ga-dev-tools.appspot.com/query-explorer/">Query Explorer</a>.</p><p>The query parameters are as follows:</p><ul><li><strong>start-date</strong>: fill in the first day of blog posting<li><strong>end-date</strong>: fill in <code class="language-plaintext highlighter-rouge">today</code> (this is a parameter supported by GA Report, which means that it will always end according to the current query date)<li><strong>metrics</strong>: select <code class="language-plaintext highlighter-rouge">ga:pageviews</code><li><strong>dimensions</strong>: select <code class="language-plaintext highlighter-rouge">ga:pagePath</code></ul><p>In order to reduce the returned results and reduce the network bandwidth, we add custom filtering rules <sup id="fnref:ga-filters" role="doc-noteref"><a href="#fn:ga-filters" class="footnote" rel="footnote">1</a></sup>:</p><ul><li><p><strong>filters</strong>: fill in <code class="language-plaintext highlighter-rouge">ga:pagePath=~^/posts/.*/$;ga:pagePath!@=</code>.</p><p>Among them, <code class="language-plaintext highlighter-rouge">;</code> means using <em>logical AND</em> to concatenate two rules.</p><p>If the <code class="language-plaintext highlighter-rouge">site.baseurl</code> is specified, change the first filtering rule to <code class="language-plaintext highlighter-rouge">ga:pagePath=~^/BASE_URL/posts/.*/$</code>, where <code class="language-plaintext highlighter-rouge">BASE_URL</code> is the value of <code class="language-plaintext highlighter-rouge">site.baseurl</code>.</p></ul><p>After <kbd>Run Query</kbd>, copy the generated contents of <strong>API Query URI</strong> at the bottom of the page and fill in the <strong>Encoded URI for the query</strong> of SuperProxy on GAE.</p><p>After the query is saved on GAE, a <strong>Public Endpoint</strong> (public access address) will be generated, and we will get the query result in JSON format when accessing it. Finally, click <kbd>Enable Endpoint</kbd> in <strong>Public Request Endpoint</strong> to make the query effective, and click <kbd>Start Scheduling</kbd> in <strong>Scheduling</strong> to start the scheduled task.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1100 126'%3E%3C/svg%3E" data-src="/posts/20210103/04-superproxy-query.png" alt="superproxy-query" width="1100" height="126" data-proofer-ignore></p><h2 id="configure-chirpy-to-display-page-view"><span class="mr-2">Configure Chirpy to Display Page View</span><a href="#configure-chirpy-to-display-page-view" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Once all the hard part is done, it is very easy to enable the Page View on Chirpy theme. Your superProxy dashboard should look something like below and you can grab the required values.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1210 694'%3E%3C/svg%3E" data-src="/posts/20210103/05-superproxy-dashboard.png" alt="superproxy-dashboard" width="1210" height="694" data-proofer-ignore></p><p>Update the <code class="language-plaintext filepath highlighter-rouge">_config.yml</code> file of <a href="https://github.com/cotes2020/jekyll-theme-chirpy/"><strong>Chirpy</strong></a> project with the values from your dashboard, to look similar to the following:</p><div file="_config.yml" class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="_config.yml"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="na">google_analytics</span><span class="pi">:</span>
  <span class="na">id</span><span class="pi">:</span> <span class="s1">'</span><span class="s">G-V6XXXXXXX'</span>   <span class="c1"># fill in your Google Analytics ID</span>
  <span class="na">pv</span><span class="pi">:</span>
    <span class="na">proxy_endpoint</span><span class="pi">:</span> <span class="s1">'</span><span class="s">https://PROJECT_ID.REGION_ID.r.appspot.com/query?id=&lt;ID</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">SUPER</span><span class="nv"> </span><span class="s">PROXY&gt;'</span>
    <span class="na">cache_path</span><span class="pi">:</span>       <span class="c1"># the local PV cache data, friendly to visitors from GFW region</span>
</pre></table></code></div></div><p>Now, you should see the Page View enabled on your blog.</p><h2 id="reference"><span class="mr-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="footnotes" role="doc-endnotes"><ol><li id="fn:ga-filters" role="doc-endnote"><p><a href="https://developers.google.com/analytics/devguides/reporting/core/v3/reference#filters">Google Analytics Core Reporting API: Filters</a> <a href="#fnref:ga-filters" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%E5%8D%9A%E5%AE%A2/'>博客</a>, <a href='/categories/%E6%8C%87%E5%8D%97/'>指南</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/%E8%AE%BF%E9%97%AE%E5%88%86%E6%9E%90/" class="post-tag no-text-decoration" >访问分析</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY-NC 4.0 </a> 进行非商业授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%E5%90%AF%E7%94%A8Google+Page+Views+-+%E7%A0%81%E5%86%9C%E4%BA%8C%E5%8D%81%E5%B9%B4&url=https%3A%2F%2Fqinsg.github.io%2Fposts%2Fenable-google-pv%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%E5%90%AF%E7%94%A8Google+Page+Views+-+%E7%A0%81%E5%86%9C%E4%BA%8C%E5%8D%81%E5%B9%B4&u=https%3A%2F%2Fqinsg.github.io%2Fposts%2Fenable-google-pv%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fqinsg.github.io%2Fposts%2Fenable-google-pv%2F&text=%E5%90%AF%E7%94%A8Google+Page+Views+-+%E7%A0%81%E5%86%9C%E4%BA%8C%E5%8D%81%E5%B9%B4" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/biguiyuan/">关于碧桂园的一些零星想法</a><li><a href="/posts/meirenzhenzengwomenhanyao/">【转】美人赠我蒙汗药</a><li><a href="/posts/buffett-inflation/">巴菲特：通货膨胀是如何欺骗股票投资者的</a><li><a href="/posts/text-and-typography/">文本和排版</a><li><a href="/posts/write-a-new-post/">发布新文章</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E9%9A%8F%E7%AC%94/">随笔</a> <a class="post-tag" href="/tags/%E6%8A%95%E8%B5%84/">投资</a> <a class="post-tag" href="/tags/%E5%85%B6%E4%BB%96/">其他</a> <a class="post-tag" href="/tags/%E5%8F%91%E5%B8%83/">发布</a> <a class="post-tag" href="/tags/%E5%92%8F%E5%8F%B2/">咏史</a> <a class="post-tag" href="/tags/%E5%9B%BE%E6%A0%87/">图标</a> <a class="post-tag" href="/tags/%E5%A1%94%E8%A5%BF%E4%BD%97%E9%99%B7%E9%98%B1/">塔西佗陷阱</a> <a class="post-tag" href="/tags/%E5%B7%B4%E8%8F%B2%E7%89%B9/">巴菲特</a> <a class="post-tag" href="/tags/%E5%BC%80%E5%A7%8B/">开始</a> <a class="post-tag" href="/tags/%E6%8E%92%E7%89%88/">排版</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/text-and-typography/"><div class="card-body"> <em class="small" data-ts="1565235180" data-df="YYYY-MM-DD" > 2019-08-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>文本和排版</h3><div class="text-muted small"><p> This post is to show Markdown syntax rendering on Chirpy, you can also use it as an example of writing. Now, let’s start looking at text and typography. Titles H1 - heading H2 - heading H3 - h...</p></div></div></a></div><div class="card"> <a href="/posts/write-a-new-post/"><div class="card-body"> <em class="small" data-ts="1565244600" data-df="YYYY-MM-DD" > 2019-08-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>发布新文章</h3><div class="text-muted small"><p> This post will guide you how to write a post on Chirpy theme. Even if you have previous experience with Jekyll, this article is worth reading, because many features require specific variables to be...</p></div></div></a></div><div class="card"> <a href="/posts/getting-started/"><div class="card-body"> <em class="small" data-ts="1565355300" data-df="YYYY-MM-DD" > 2019-08-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>开始使用</h3><div class="text-muted small"><p> Prerequisites Follow the instructions in the Jekyll Docs to complete the installation of Ruby, RubyGems, Jekyll, and Bundler. In addition, Git is also required to be installed. Installation Crea...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/getting-started/" class="btn btn-outline-primary" prompt="上一篇"><p>开始使用</p></a> <a href="/posts/customize-the-favicon/" class="btn btn-outline-primary" prompt="下一篇"><p>如何定制图标</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://qinsg.github.io/posts/enable-google-pv/'; this.page.identifier = '/posts/enable-google-pv/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://qinsg.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/qinsg">James Qin</a>. <span data-toggle="tooltip" data-placement="top" title="您可以按照知识共享署名4.0国际(CC BY-NC 4.0)许可协议将文章用于非商业用途；但若需用于商业用途，请联系站长获取授权。">保留所有权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E9%9A%8F%E7%AC%94/">随笔</a> <a class="post-tag" href="/tags/%E6%8A%95%E8%B5%84/">投资</a> <a class="post-tag" href="/tags/%E5%85%B6%E4%BB%96/">其他</a> <a class="post-tag" href="/tags/%E5%8F%91%E5%B8%83/">发布</a> <a class="post-tag" href="/tags/%E5%92%8F%E5%8F%B2/">咏史</a> <a class="post-tag" href="/tags/%E5%9B%BE%E6%A0%87/">图标</a> <a class="post-tag" href="/tags/%E5%A1%94%E8%A5%BF%E4%BD%97%E9%99%B7%E9%98%B1/">塔西佗陷阱</a> <a class="post-tag" href="/tags/%E5%B7%B4%E8%8F%B2%E7%89%B9/">巴菲特</a> <a class="post-tag" href="/tags/%E5%BC%80%E5%A7%8B/">开始</a> <a class="post-tag" href="/tags/%E6%8E%92%E7%89%88/">排版</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">发现新版本的内容。</p><button type="button" class="btn btn-primary" aria-label="Update"> 更新 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-5110757-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-5110757-1'); }); </script>
